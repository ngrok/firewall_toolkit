{"nftables": [{"metainfo": {"version": "1.0.2", "release_name": "Lester Gooch", "json_schema_version": 1}}, {"table": {"family": "inet", "name": "compat-test", "handle": 1002}}, {"set": {"family": "inet", "name": "ipv4_blocklist", "table": "compat-test", "type": "ipv4_addr", "handle": 2, "flags": ["interval"], "elem": [{"elem": {"val": {"range": ["198.51.100.1", "198.51.100.100"]}, "counter": {"packets": 0, "bytes": 0}}}, {"elem": {"val": "198.51.100.200", "counter": {"packets": 0, "bytes": 0}}}, {"elem": {"val": {"prefix": {"addr": "203.0.113.100", "len": 30}}, "counter": {"packets": 0, "bytes": 0}}}]}}, {"set": {"family": "inet", "name": "ipv6_blocklist", "table": "compat-test", "type": "ipv6_addr", "handle": 3, "flags": ["interval"], "elem": [{"elem": {"val": {"prefix": {"addr": "2001:db80:1234::", "len": 48}}, "counter": {"packets": 0, "bytes": 0}}}, {"elem": {"val": "2001:db80:85a3:1:1:8a2e:1370:7334", "counter": {"packets": 0, "bytes": 0}}}, {"elem": {"val": {"range": ["2001:db80:85a3:1:1:8a2e:1370:7336", "2001:db80:85a3:1:1:8a2e:1370:7339"]}, "counter": {"packets": 0, "bytes": 0}}}]}}, {"set": {"family": "inet", "name": "port_blocklist", "table": "compat-test", "type": "inet_service", "handle": 4, "flags": ["interval"], "elem": [{"elem": {"val": {"range": [1000, 1001]}, "counter": {"packets": 0, "bytes": 0}}}, {"elem": {"val": {"range": [3000, 4999]}, "counter": {"packets": 0, "bytes": 0}}}, {"elem": {"val": 8080, "counter": {"packets": 0, "bytes": 0}}}]}}, {"chain": {"family": "inet", "table": "compat-test", "name": "filter", "handle": 1, "type": "filter", "hook": "input", "prio": 0, "policy": "accept"}}, {"rule": {"family": "inet", "table": "compat-test", "chain": "filter", "handle": 5, "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "saddr"}}, "right": "@ipv4_blocklist"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "dport"}}, "right": "@port_blocklist"}}, {"counter": {"packets": 0, "bytes": 0}}, {"drop": null}]}}, {"rule": {"family": "inet", "table": "compat-test", "chain": "filter", "handle": 6, "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip6", "field": "saddr"}}, "right": "@ipv6_blocklist"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "dport"}}, "right": "@port_blocklist"}}, {"counter": {"packets": 0, "bytes": 0}}, {"drop": null}]}}]}
